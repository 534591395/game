var egret=window.egret,__reflect=this&&this.__reflect||function(e,t,i){e.__class__=t,i?i.push(t):i=[t],e.__types__=e.__types__?i.concat(e.__types__):i},__extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);i.prototype=t.prototype,e.prototype=new i},__awaiter=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(r,s){function o(e){try{h(n.next(e))}catch(t){s(t)}}function a(e){try{h(n["throw"](e))}catch(t){s(t)}}function h(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(o,a)}h((n=n.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;h;)try{if(r=1,s&&(o=s[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(s,i[1])).done)return o;switch(s=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,s=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(o=h.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){h.label=i[1];break}if(6===i[0]&&h.label<o[1]){h.label=o[1],o=i;break}if(o&&h.label<o[2]){h.label=o[2],h.ops.push(i);break}o[2]&&h.ops.pop(),h.trys.pop();continue}i=t.call(e,h)}catch(n){i=[6,n],s=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,s,o,a,h={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},LevelGroup=function(e){function t(t,i){void 0===t&&(t=9),void 0===i&&(i=[1]);var n=e.call(this)||this;return n.levels=[],n.levelNum=9,n.unlock=[1],n.rowNum=3,n.levelNum=t,n.unlock=i,n.myGroup=new eui.Group,n.game=new Game,n.addEventListener(egret.Event.ADDED_TO_STAGE,n.render,n),n.game.addEventListener(CustomHandleEvent.ReturnLevel,n.returnLevel,n),n.game.addEventListener(CustomHandleEvent.UpdateLevel,n.updateLevel,n),n}return __extends(t,e),t.prototype.updateLevel=function(e){this.unlockLevel(e.levelNum)},t.prototype.returnLevel=function(){this.addChild(this.myGroup),this.addChild(this.txt),this.removeChild(this.game)},t.prototype.textField=function(){this.txt=new egret.TextField,this.txt.width=this.stage.stageWidth,this.txt.height=200,this.txt.textAlign="center",this.txt.textColor=16777215,this.txt.size=40,this.txt.y=0,this.txt.text="关卡选择",this.addChild(this.txt)},t.prototype.render=function(){this.textField(),this.tLayout();for(var e=0;e<this.levelNum;e+=1){var t=void 0,i=e+1;this.unlock.indexOf(i)>-1?(t=new Level(!1,i),t.addEventListener(CustomHandleEvent.ChoiceLevel,this.gameStartHandle,this)):t=new Level(!0,i),this.levels.push(t),this.myGroup.addChild(t)}this.addChild(this.myGroup)},t.prototype.tLayout=function(){this.myGroup.width=this.stage.stageWidth,this.myGroup.height=400;var e=new eui.TileLayout;e.horizontalGap=0,e.verticalGap=0,e.columnAlign=eui.ColumnAlign.JUSTIFY_USING_WIDTH,e.rowAlign=eui.RowAlign.JUSTIFY_USING_HEIGHT,e.horizontalAlign=egret.HorizontalAlign.CENTER,e.paddingTop=0,e.paddingRight=0,e.paddingLeft=0,e.paddingBottom=10,e.requestedColumnCount=this.rowNum,this.myGroup.layout=e,this.myGroup.y=80},t.prototype.unlockLevel=function(e){var t=this;-1===this.unlock.indexOf(e)&&this.unlock.push(e),this.levels.map(function(e,i){t.unlock.indexOf(i+1)>-1&&e.isLock&&(e.isLock=!1,e.number=i+1,e.render(),e.addEventListener(CustomHandleEvent.ChoiceLevel,t.gameStartHandle,t))})},t.prototype.gameStartHandle=function(e){this.game.levelChange(e.levelNum),this.removeChild(this.myGroup),this.removeChild(this.txt),this.addChild(this.game)},t}(egret.DisplayObjectContainer);__reflect(LevelGroup.prototype,"LevelGroup");var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,i){function n(n){t.call(i,n,e)}if(RES.hasRes(e)){var r=RES.getRes(e);r?n(r):RES.getResAsync(e,n,this)}else RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Enemy=function(e){function t(){var t=e.call(this)||this;return t.gravity=0,t.velX=0,t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(){var e=this.createBitmapByName("fish04_png");e.width=40,e.height=40,e.rotation=0,this.addChild(e)},t.prototype.render=function(){this.x=this.posX},t.prototype.update=function(){this.velX+=this.gravity,this.posX+=this.velX},t.prototype.createBitmapByName=function(e){var t=new egret.Bitmap,i=RES.getRes(e);return t.texture=i,t.name=e,t},t}(egret.DisplayObjectContainer);__reflect(Enemy.prototype,"Enemy");var EnemyMap=function(e){function t(t){var i=e.call(this)||this;return i.map=t,i.addEventListener(egret.Event.ADDED_TO_STAGE,i.onAddToStage,i),i}return __extends(t,e),t.prototype.onAddToStage=function(){var e=new Enemy;e.x=200,e.y=100,this.addChild(e)},t}(egret.DisplayObjectContainer);__reflect(EnemyMap.prototype,"EnemyMap");var Fish=function(e){function t(t,i,n,r){var s=e.call(this)||this;return s.gravity=0,s.velX=0,s.velY=0,s.velZ=0,s.counter=0,s.TO_RADIANS=Math.PI/180,s.size=1,s.enabled=!0,s.posX=t,s.posY=i,s.posZ=n,s.fishBitmap=r,s.addChild(r),s}return __extends(t,e),t.prototype.render=function(){var e=.04*Math.sin(.4*this.counter)+this.size,t=.04*Math.sin(Math.PI+.4*this.counter)+this.size;this.x=this.posX,this.y=this.posY,this.scaleX=e,this.scaleY=t},t.prototype.update=function(){this.velY+=this.gravity,this.posX+=this.velX,this.posY+=this.velY,this.posZ+=this.velZ,this.counter++,this.rotate(2)},t.prototype.rotate=function(e,t){var i=Math.cos(e*(t?1:this.TO_RADIANS)),n=Math.sin(e*(t?1:this.TO_RADIANS)),r=this.stage.stageWidth/2,s=this.posX-r;this.posX=s*i-this.posZ*n+r,this.posZ=s*n+this.posZ*i,s=this.velX,this.velX=s*i-this.velZ*n,this.velZ=s*n+this.velZ*i},t}(egret.DisplayObjectContainer);__reflect(Fish.prototype,"Fish");var FishEmitter=function(e){function t(){var t=e.call(this)||this;return t.particles=[],t.spareParticles=[],t}return __extends(t,e),t.prototype.update=function(){for(var e=0;e<this.particles.length;e++){var t=this.particles[e];t.enabled&&(t.update(),t.enabled||this.removeParticle(t))}},t.prototype.removeParticle=function(e){this.removeChild(e),e.enabled=!1,this.spareParticles.push(e)},t.prototype.makeParticle=function(){var e;return this.spareParticles.length>0?(e=this.spareParticles.shift(),this.addChild(e)):(e=new FishParticle,this.particles.push(e),this.addChild(e)),e.enabled=!0,e},t.prototype.makeExplosion=function(e,t){for(var i=0;30>i;i++){var n=this.makeParticle();n.x=e,n.y=t,n.xVel=Math.random()-.5,n.yVel=Math.random()-.5,n.zVel=Math.random()-.5;var r=Math.sqrt(n.xVel*n.xVel+n.yVel*n.yVel+n.zVel*n.zVel);n.xVel*=40/r,n.yVel*=40/r,n.zVel*=40/r,n.size=1.5,n.update()}},t.prototype.clearAll=function(){var e=this;this.particles.map(function(t){t.enabled&&e.removeParticle(t)})},t}(egret.DisplayObjectContainer);__reflect(FishEmitter.prototype,"FishEmitter");var FishParticle=function(e){function t(){var t=e.call(this)||this;return t.xVel=0,t.yVel=0,t.size=1,t.enabled=!0,t.render(),t}return __extends(t,e),t.prototype.render=function(){var e=this.createBitmapByName("orangeParticle_png");this.width=32,this.height=32,this.addChild(e)},t.prototype.update=function(){var e=.84;this.xVel*=e,this.yVel*=e,this.x+=this.xVel,this.y+=this.yVel,this.size*=.9,this.scaleX=this.size,this.scaleY=this.size,this.size<.05&&(this.enabled=!1)},t.prototype.createBitmapByName=function(e){var t=new egret.Bitmap,i=RES.getRes(e);return t.texture=i,t.name=e,t},t}(egret.DisplayObjectContainer);__reflect(FishParticle.prototype,"FishParticle");var Game=function(e){function t(){var t=e.call(this)||this;return t.time=1e3,t.timeNum=20,t.counter=0,t.frequencyFish=8,t.delFish=0,t.spareFishes=[],t.fishes=[],t.level=1,t.gravity=-.2,t.originNum=30,t.render(),t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onCreateBannerAd,t),t}return __extends(t,e),t.prototype.onCreateBannerAd=function(){try{this.bannerAd&&this.bannerAd.destroy(),this.bannerAd=wx.createBannerAd({adUnitId:"adunit-e808c74164a5538a",style:{left:0,top:this.stage.stageHeight/2-50,width:this.stage.stageWidth,height:120}}),this.bannerAd.onError(function(e){})}catch(e){console.log(e)}},t.prototype.levelChange=function(e){void 0===e&&(e=1),this.level=e,this.timeNum=20,this.gravity=-.2,this.timeNum=this.timeNum-(this.level-1),this.gravity=this.gravity+-this.level/10,this.scorePanel.setOriginNum(29+this.level),this.scorePanel.showStart(),this.timer.repeatCount=this.timeNum},t.prototype.render=function(){this.fishEmitter=new FishEmitter,this.addChild(this.fishEmitter),this.pannelUI(),this.gameTimer(),this.TxtTimer()},t.prototype.pannelUI=function(){this.scorePanel=new ScorePanel,this.scorePanel.touchEnabled=!0,this.scorePanel.x=0,this.scorePanel.y=100,this.addChild(this.scorePanel),this.scorePanel.addEventListener(CustomHandleEvent.GameStart,this.gameStart,this),this.scorePanel.addEventListener(CustomHandleEvent.ReturnLevel,this.returnLevel,this),this.scorePanel.addEventListener(CustomHandleEvent.UpdateLevel,this.updateLevel,this),this.scorePanel.addEventListener(CustomHandleEvent.NextLevel,this.nextLevel,this)},t.prototype.updateLevel=function(){var e=new CustomHandleEvent(CustomHandleEvent.UpdateLevel);e.levelNum=this.level+1,console.log("发起更新通关关卡",this.level+1),this.dispatchEvent(e)},t.prototype.returnLevel=function(){var e=new CustomHandleEvent(CustomHandleEvent.ReturnLevel);this.dispatchEvent(e)},t.prototype.nextLevel=function(e){var t=this.level+1;this.levelChange(t),console.log("下一关关卡"+t)},t.prototype.gameTimer=function(){this.timer=new egret.Timer(this.time,this.timeNum),this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc,this)},t.prototype.TxtTimer=function(){this.txt=new egret.TextField,this.txt.width=70,this.txt.height=50,this.txt.textAlign="center",this.txt.textColor=16777215,this.txt.size=30,this.txt.y=20,this.txt.x=20,this.addChild(this.txt)},t.prototype.timerFunc=function(){this.txt.text=this.timer.repeatCount-this.timer.currentCount+"S"},t.prototype.timerComFunc=function(){this.gameEnd()},t.prototype.gameEnd=function(){var e=this;this.removeEventListener(egret.Event.ENTER_FRAME,this.onGameLoop,this),this.scorePanel.showScore(this.delFish),this.addChild(this.scorePanel),this.clearFish(),this.fishEmitter.clearAll();try{setTimeout(function(){e.bannerAd.show()},1e3),console.log("显示广告")}catch(t){console.log(t)}},t.prototype.gameStart=function(){try{this.bannerAd.hide(),console.log("隐藏广告"),this.onCreateBannerAd(),console.log("重新拉取广告")}catch(e){console.log(e)}this.txt.text=this.timer.repeatCount+"S",this.timer.reset(),this.timer.start();try{this.removeChild(this.scorePanel)}catch(e){}this.addEventListener(egret.Event.ENTER_FRAME,this.onGameLoop,this)},t.prototype.onGameLoop=function(){var e=this;this.counter++%this.frequencyFish==0&&this.makeFish(),this.fishes.map(function(t){t.enabled&&(t.update(),t.render(),t.posY<-200&&e.removeFish(t))}),this.fishEmitter.update()},t.prototype.makeFish=function(){var e;if(this.spareFishes.length)e=this.spareFishes.pop(),e.enabled=!0,this.addChild(e);else{var t=this.createBitmapByName("orangefish0"+(this.fishes.length%4+1)+"_png");e=new Fish(0,0,0,t),this.fishes.push(e),e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.explodeFish,this),e.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.explodeFish,this),this.addChild(e)}var i=this.stage.stageWidth/2;e.posX=i+this.randomRange(-250,250),e.posY=this.stage.stageHeight+10,e.posZ=this.randomRange(-250,250),e.velX=this.randomRange(-1,1),e.velY=this.randomRange(-1,-2),e.velZ=this.randomRange(-1,1),e.size=1,e.gravity=this.gravity},t.prototype.explodeFish=function(e){var t=e.target;this.fishEmitter.makeExplosion(t.posX,t.posY),this.removeFish(t),this.delFish++},t.prototype.removeFish=function(e){e.enabled=!1,this.removeChild(e),this.spareFishes.push(e)},t.prototype.clearFish=function(){var e=this;this.delFish=0,this.counter=0,this.fishes.map(function(t){t.enabled&&e.removeFish(t)})},t.prototype.randomRange=function(e,t){return Math.random()*(t-e)+e},t.prototype.createBitmapByName=function(e){var t=new egret.Bitmap,i=RES.getRes(e);return t.texture=i,t},t}(egret.DisplayObjectContainer);__reflect(Game.prototype,"Game");var Level=function(e){function t(t,i){var n=e.call(this)||this;return n.isLock=!0,n.skinName="resource/skins/level.exml",n.isLock=t,n.number=i,n.width=n.level_lock.width,n.height=n.level_lock.height,n.render(),n.animateEvent(),n}return __extends(t,e),t.prototype.render=function(){this.isLock?(this.level_lock.visible=!0,this.level_unlock.visible=!1):(this.level_unlock.visible=!0,this.level_lock.visible=!1,this.level_id.source="number_"+this.number+"_png")},t.prototype.animateEvent=function(){var e=this;this.level_unlock.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.level.play(0)},this),this.level.addEventListener("complete",function(){var t=new CustomHandleEvent(CustomHandleEvent.ChoiceLevel);t.levelNum=e.number,e.dispatchEvent(t)},this),this.level_lock.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.lock.play(0)},this)},t}(eui.Component);__reflect(Level.prototype,"Level");var BgMap=function(e){function t(){var t=e.call(this)||this;return t.bgSpeed=20,t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this);var e=this.stage.stageWidth,t=this.stage.stageHeight;this.textureHeight=t,this.rowCount=Math.ceil(t/this.textureHeight)+1,this.bmpParallaxBackArr=[],this.bmpParallaxFrontArr=[];for(var i=0;i<this.rowCount;i+=1){var n=this.createBitmapByName("parallaxBack_jpg");n.y=this.textureHeight*i-(this.textureHeight*this.rowCount-t),n.width=e,n.height=t,this.bmpParallaxBackArr.push(n),this.addChild(n)}for(var i=0;i<this.rowCount;i+=1){var r=this.createBitmapByName("parallaxFront_png");r.y=this.textureHeight*i-(this.textureHeight*this.rowCount-t),r.width=e,r.height=t,this.bmpParallaxFrontArr.push(r),this.addChild(r)}},t.prototype.createBitmapByName=function(e){var t=new egret.Bitmap,i=RES.getRes(e);return t.texture=i,t.name=e,t},t.prototype.start=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this.enterFrameHandler,this),this.addEventListener(egret.Event.ENTER_FRAME,this.enterFrameHandler,this)},t.prototype.pause=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this.enterFrameHandler,this)},t.prototype.enterFrameHandler=function(e){for(var t=0;t<this.rowCount;t+=1){var i=this.bmpParallaxFrontArr[t];i.y+=2*this.bgSpeed,i.y>this.stage.stageHeight&&(i.y=this.bmpParallaxFrontArr[0].y-this.textureHeight,this.bmpParallaxFrontArr.pop(),this.bmpParallaxFrontArr.unshift(i));var n=this.bmpParallaxBackArr[t];n.y+=this.bgSpeed,n.y>this.stage.stageHeight&&(n.y=this.bmpParallaxBackArr[0].y-this.textureHeight,this.bmpParallaxBackArr.pop(),this.bmpParallaxBackArr.unshift(n))}},t}(egret.DisplayObjectContainer);__reflect(BgMap.prototype,"BgMap");var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t.skinName="resource/skins/loading.exml",t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField)},t.prototype.onProgress=function(e,t){this.loading.width=e/t*428},t}(eui.Component);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(e){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(e){console.log(e)})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.loadResource()];case 1:return e.sent(),this.createGameScene(),[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,5,,6]),egret.ImageLoader.crossOrigin="anonymous",[4,RES.loadConfig("default.res.json","https://wxgame.dreamrabbit.tech/game/resource/")];case 1:return i.sent(),[4,this.loadTheme()];case 2:return i.sent(),[4,RES.loadGroup("loading",1)];case 3:return i.sent(),e=new LoadingUI,this.stage.addChild(e),[4,RES.loadGroup("preload",0,e)];case 4:return i.sent(),this.stage.removeChild(e),[3,6];case 5:return t=i.sent(),console.error(t),[3,6];case 6:return[2]}})})},t.prototype.loadTheme=function(){var e=this;return new Promise(function(t,i){var n=new eui.Theme("resource/default.thm.json",e.stage);n.addEventListener(eui.UIEvent.COMPLETE,function(){t()},e)})},t.prototype.createGameScene=function(){this.addChild(new Map)},t}(eui.UILayer);__reflect(Main.prototype,"Main");var Map=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this);var e=this,t="https://wxgame.dreamrabbit.tech/game/resource/assets/cc.tmx",i=new egret.URLLoader;i.dataFormat=egret.URLLoaderDataFormat.TEXT,i.load(new egret.URLRequest(t)),i.addEventListener(egret.Event.COMPLETE,function(i){var n=egret.XML.parse(i.target.data),r=new tiled.TMXTilemap(2e3,2e3,n,t);r.render(),e.addChild(r);var s=r.getChildByName("bomb");e.bomb(s),e.enemy(r.getChildByName("enemy"))},t)},t.prototype.addBomb=function(e,t,i){i++,(3==i||i>4)&&(i=1);var n=this;e.x=t.x,e.y=t.y-40,e.width=40,e.height=40,this.addChild(e),setTimeout(function(){n.removeChild(e),e=n.createBitmapByName("bomp_"+i+"_png"),n.addBomb(e,t,i)},1e3)},t.prototype.bomb=function(e){var t=this,i=e._childrens||[];console.log(i),i.map(function(e,i){var n=i+1,r=t.createBitmapByName("bomp_"+n+"_png"),s=e.attributes;t.addBomb(r,s,n)})},t.prototype.enemy=function(e){this.enemyMap=new EnemyMap(e),this.addChild(this.enemyMap),this.enemyMap.visible=!1},t.prototype.getProperties=function(e,t){},t.prototype.move=function(e){e.target.x-=5,e.target.y-=5},t.prototype.createBitmapByName=function(e){var t=new egret.Bitmap,i=RES.getRes(e);return t.texture=i,t.name=e,t},t}(egret.DisplayObjectContainer);__reflect(Map.prototype,"Map");var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ScorePanel=function(e){function t(){var t=e.call(this)||this;return t.originNum=30,t.win=!1,t.render(),t}return __extends(t,e),t.prototype.render=function(){this.defautUI(),this.winUI()},t.prototype.defautUI=function(){this.tipView=new TipView,this.gameStartEvent=new CustomHandleEvent(CustomHandleEvent.GameStart),this.tipView.addEventListener(CustomHandleEvent.CompleteAnimation,this.gameStartHandle,this),this.tipView.addEventListener(CustomHandleEvent.ReturnLevelAnimation,this.returnLevel,this)},t.prototype.returnLevel=function(){var e=new CustomHandleEvent(CustomHandleEvent.ReturnLevel);this.dispatchEvent(e)},t.prototype.updateLevel=function(){var e=new CustomHandleEvent(CustomHandleEvent.UpdateLevel);this.dispatchEvent(e)},t.prototype.setOriginNum=function(e){void 0===e&&(e=30),this.originNum=e},t.prototype.showScore=function(e){var t="";if(e<this.originNum?(t="很遗憾，未达到目标！\n",this.win=!1):this.win=!0,this.win){this.updateLevel(),this.nextUI.enterAnimation(),this.addChild(this.nextUI);try{this.removeChild(this.tipView)}catch(i){}}else{try{this.removeChild(this.nextUI)}catch(i){}this.addChild(this.tipView),this.tipView.setText("您的成绩是："+e+"条\n\n"+t+"\n点击开始再来一次吧")}},t.prototype.showStart=function(){this.win=!1,this.tipView.setText("游戏开始后请滑破"+this.originNum+"条泡泡鱼\n\n点击开始吧");try{this.removeChild(this.nextUI),this.removeChild(this.tipView)}catch(e){}this.addChild(this.tipView)},t.prototype.gameStartHandle=function(){this.dispatchEvent(this.gameStartEvent)},t.prototype.winUI=function(){this.nextUI=new Win,this.nextUI.addEventListener(CustomHandleEvent.NextLevel,this.nextLevel,this),this.nextUI.addEventListener(CustomHandleEvent.ReturnLevelAnimation,this.returnLevel,this)},t.prototype.nextLevel=function(){var e=new CustomHandleEvent(CustomHandleEvent.NextLevel);this.dispatchEvent(e)},t}(egret.Sprite);__reflect(ScorePanel.prototype,"ScorePanel");var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,i,n){function r(e){t.call(n,e)}function s(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),i.call(n))}var o=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){t.call(n,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(e,i){window.JSONParseClass.setData(e),egret.callLater(function(){t.call(n,generateEUI2)},o)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(e.indexOf(".exml")>-1){var a=e.split("/");a.pop();var h=a.join("/")+"_EUI.json";generateJSON.paths[e]?egret.callLater(function(){t.call(n,generateJSON.paths[e])},this):RES.getResByUrl(h,function(i){window.JSONParseClass.setData(i),egret.callLater(function(){t.call(n,generateJSON.paths[e])},o)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){t.call(n,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),RES.getResByUrl(e,r,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var TipView=function(e){function t(){var t=e.call(this)||this;return t.isClick=!1,t.skinName="resource/skins/tip.exml",t.text.textAlign="center",t.text.textColor=16777215,t.text.size=24,t.text.y=100,t.init(),t}return __extends(t,e),t.prototype.init=function(){var e=this,t=new CustomHandleEvent(CustomHandleEvent.CompleteAnimation),i=new CustomHandleEvent(CustomHandleEvent.ReturnLevelAnimation);this.btn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.start.play(0)},this),this.start.addEventListener("complete",function(){e.dispatchEvent(t)},this),this.LevelList.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.returnLevel.play(0)},this),this.returnLevel.addEventListener("complete",function(){e.dispatchEvent(i)},this)},t.prototype.setText=function(e){this.text.text=e},t}(eui.Component);__reflect(TipView.prototype,"TipView");var Win=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/win.exml",t.init(),t}return __extends(t,e),t.prototype.init=function(){var e=this;this.next.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.nextAnimation.play(0)},this),this.nextAnimation.addEventListener("complete",function(){var t=new CustomHandleEvent(CustomHandleEvent.NextLevel);e.dispatchEvent(t)},this),this.LevelList.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.returnLevel.play(0)},this),this.returnLevel.addEventListener("complete",function(){var t=new CustomHandleEvent(CustomHandleEvent.ReturnLevelAnimation);e.dispatchEvent(t)},this)},t.prototype.enterAnimation=function(){var e=this;this.winTextAnimation.play(0),this.winTextAnimation.addEventListener("complete",function(){e.nextShowAnimation.play(0)},this)},t}(eui.Component);__reflect(Win.prototype,"Win");var CustomHandleEvent=function(e){function t(t,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1);var r=e.call(this,t,i,n)||this;return r.levelNum=1,r}return __extends(t,e),t.GameStart="游戏开始",t.CompleteAnimation="按钮动画结束",t.ChoiceLevel="选择关卡",t.ReturnLevel="返回关卡",t.ReturnLevelAnimation="返回关卡",t.NextLevel="进入下一关",t.UpdateLevel="更新通关的关卡信息",t}(egret.Event);__reflect(CustomHandleEvent.prototype,"CustomHandleEvent"),window.Main=Main;